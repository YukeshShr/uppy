---
title: "Uppy 2.0.0: smaller, faster, more awesome. Preact X, stricter types, separate Base and UI Plugin"
date: 2021-08-30
author: 
  - aduh95
  - murderlon
  - arturi
  - renee
  - mifi
image: https://uppy.io/images/blog/2.0/uppy-2-0-cover.jpg
published: true
---

![Uppy 2.0 ui with files](/images/blog/2.0/uppy-2-0-cover.jpg)

Uppy 2.0 is smaller and faster, thanks to dropping support for IE11 and a lot of refactorings. We’ve upgraded to Preact X and other dependencies, improved TypeScript support and screenreader accessibility, added support for multiple messages in the Informer plugin.

## New modern bundle — no polyfills

In Uppy 2.0.0, we’ve removed all built-in polyfills. If you need your app to
support older browser (such as IE 11), you should add the following polyfills to your bundle:

- [abortcontroller-polyfill](https://github.com/mo/abortcontroller-polyfill)
- [core-js](https://github.com/zloirock/core-js)
- [md-gum-polyfill](https://github.com/mozdevs/mediaDevices-getUserMedia-polyfill)
- [resize-observer-polyfill](https://github.com/que-etc/resize-observer-polyfill)
- [whatwg-fetch](https://github.com/github/fetch)

If you're using a bundler, you need import them before Uppy:

```js
import 'core-js'
import 'whatwg-fetch'
import 'abortcontroller-polyfill/dist/polyfill-patch-fetch'
// Order matters: AbortController needs fetch which needs Promise (provided by core-js).

import 'md-gum-polyfill'
import ResizeObserver from 'resize-observer-polyfill'

window.ResizeObserver ??= ResizeObserver

export { default } from '@uppy/core'
export * from '@uppy/core'
```

If you're using Uppy from CDN, we now provide two bundles, one for up-to-date browsers that do not include polyfills and use modern syntax, and one for legacy browsers. When migrating, be mindful about which browsers you want to support:

```html
<!-- Modern browsers (recommended) -->
<script src="https://releases.transloadit.com/uppy/v2.0.0/uppy.min.js"></script>

<!-- Legacy browsers (IE11+) -->
<script nomodule src="https://releases.transloadit.com/uppy/v2.0.0/uppy.legacy.min.js"></script>
<script type="module">import"https://releases.transloadit.com/uppy/v2.0.0/uppy.min.js";</script>
```

## Preact X and upgraded dependencies

We’ve upgraded almost all of Uppy’s dependencies. This includes the migration to Preact X. All plugins that depend on Preact have been upgraded from `8.2.9` to the latest version `10.5.13`.

Other notable upgrades: browserify to `v10`, typescript to `v4.3`, autoprefixer to `v10` and lerna to `v4`.

## `Plugin` is replaced with `BasePlugin` and `UIPlugin`

`@uppy/core` provided a `Plugin` class for creating plugins. This was used for any official plugin, but also for users who want to create their own plugin. But `Plugin` always came bundled with Preact, even if the plugin itself didn't add any UI elements.

As of Uppy 2.0.0, `Plugin` has been replaced with `BasePlugin` and `UIPlugin`. `BasePlugin` is the minimum you need to create a plugin and `UIPlugin` adds Preact for rendering user interfaces.

## Strict TypeScript types by default

Uppy used to have loose types by default and strict types as opt-in. The default export was a function that returned the `Uppy` class, and the types came bundled with the default export (`Uppy.SomeType`).

```ts
import Uppy from '@uppy/core'
import Tus from '@uppy/tus'

const uppy = Uppy<Uppy.StrictTypes>()

uppy.use(Tus, {
  invalidOption: null, // this will make the compilation fail!
})
```

Uppy is now strictly typed by default and loose types have been removed. The default export is the `Uppy` class and not a function. This means you need to call `Uppy` with the `new` keyword when initializing it.

```ts
// ...

const uppy = new Uppy()

uppy.use(Tus, {
  invalidOption: null, // this will make the compilation fail!
})
```

Uppy types are now individual exports and should be imported separately.

<!-- eslint-disable @typescript-eslint/no-unused-vars -->
```ts
import type { PluginOptions, UIPlugin, PluginTarget } from '@uppy/core'
```

### Event types

Uppy core provides an [`.on`](https://uppy.io/docs/uppy/#uppy-on-39-event-39-action) method to listen to [events](https://uppy.io/docs/uppy/#Events).
The types for these were loose and allowed for invalid events to be passed, such as `uppy.on('upload-errrOOOoooOOOOOrrrr')`.
Events have received a big update thanks to [Hawxy](https://github.com/Hawxy), making them more strict and accurate.

A breaking was required to make this happen.

<!-- eslint-disable @typescript-eslint/no-unused-vars -->
```ts
// Before
type Meta = { myCustomMetadata: string }

// invalid event
uppy.on<Meta>('upload-errrOOOoooOOOOOrrrr', () => {
  // ...
})

// after

// Normal event signature
uppy.on('complete', (result) => {
  const successResults = result.successful
})

// Custom signature
type Meta = { myCustomMetadata: string }

// Notice how the custom type has now become the second argument
uppy.on<'complete', Meta>('complete', (result) => {
  // The passed type is now merged into the `meta` types.
  const meta = result.successful[0].meta.myCustomMetadata
})
```

Using official Uppy plugins that add their own events are automatically added to the namespace.
For instance, when using `@uppy/dashboard`:

<!-- eslint-disable @typescript-eslint/no-unused-vars -->
```ts
uppy.on('dashboard:file-edit-state', (file) => {
  const fileName = file.name
})
```

## Batch pre-signing URL's for AWS S3 Multipart

The [`@uppy/aws-s3-multipart`](https://uppy.io/docs/aws-s3-multipart/) plugin can be used to upload files directly to an S3 bucket using S3’s Multipart upload strategy. With this strategy, files are chopped up in parts of 5MB+ each, so they can be uploaded concurrently. It is also very reliable: if a single part fails to upload, only that 5MB chunk has to be retried.

However, every part needed to make a trip to the server to generate a pre-signed URL. This means a 1GB file uploaded in 5mb chunks would require 200 trips to the server.

As of Uppy 2.0.0, we now pre-sign URLs in batches. That same 1GB file now only takes 50 trips to the server (if the limit was 4).

## And more

- The default export of `@uppy/core` is now the `Uppy` class, which means you always need to invoke it with the `new` keyword. This used to be a function which returned the `Uppy` class.

- The `.run` method on the `Uppy` instance has been removed. This method was already obsolute and only logged a warning. As of this major version it no longer exists.

- `@uppy/informer` now supports showing multiple notifications at the same time. The notifications themselves have also been improved.

- Improved screenreader accessibility for checkboxes and the remove file button for `@uppy/dashboard`.

- Sort files and folders alphabetically in the Google Drive provider.

- Polished our code base with improved eslint rules, private field methods, and other modern JavaScript features that help us write more intention revealing and safe code.

- To make Uppy more inclusive for contributions, and to avoid an oppresive metaphor, we have renamed our `master` branch to `main`.
